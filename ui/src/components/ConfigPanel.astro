---
// Static UI for inline Guard Config section
import PatternSelector from "./PatternSelector.astro";
---

<div id="config-panel" class="bg-card border rounded-lg p-6 mt-6">
  <h2 class="text-lg font-semibold mb-4 text-card-foreground">Config</h2>
  <div id="config-disabled-hint" class="text-sm text-muted-foreground mb-3" style="display:none;">Conecta al menos un slave para configurar.</div>

  <div class="space-y-5">
    <!-- Protecci칩n / patr칩n -->
    <div>
      <!-- Componente con opciones y emojis alineados con Guard -->
      <!-- Usamos el mismo id gc-protectionPattern para compatibilidad -->
      <PatternSelector />
    </div>

    <!-- Toggles principales -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div class="flex items-center justify-between">
        <span class="text-sm text-card-foreground">Preferir color espec칤fico</span>
        <label class="relative inline-flex w-9 h-5 items-center cursor-pointer select-none">
          <input type="checkbox" id="gc-preferColor" class="opacity-0 absolute w-0 h-0" />
          <span data-role="track" class="absolute inset-0 rounded-full transition-colors duration-300 bg-red-500"></span>
          <span data-role="knob" class="absolute left-0.5 top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full transition-transform duration-300 translate-x-0"></span>
        </label>
      </div>
      <div class="flex items-center justify-between">
        <span class="text-sm text-card-foreground">Excluir colores espec칤ficos</span>
        <label class="relative inline-flex w-9 h-5 items-center cursor-pointer select-none">
          <input type="checkbox" id="gc-excludeColor" class="opacity-0 absolute w-0 h-0" />
          <span data-role="track" class="absolute inset-0 rounded-full transition-colors duration-300 bg-red-500"></span>
          <span data-role="knob" class="absolute left-0.5 top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full transition-transform duration-300 translate-x-0"></span>
        </label>
      </div>
      <div class="flex items-center justify-between">
        <span class="text-sm text-card-foreground">Usar tiempos aleatorios</span>
        <label class="relative inline-flex w-9 h-5 items-center cursor-pointer select-none">
          <input type="checkbox" id="gc-randomWaitTime" class="opacity-0 absolute w-0 h-0" />
          <span data-role="track" class="absolute inset-0 rounded-full transition-colors duration-300 bg-red-500"></span>
          <span data-role="knob" class="absolute left-0.5 top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full transition-transform duration-300 translate-x-0"></span>
        </label>
      </div>
      <div class="flex items-center justify-between">
        <span class="text-sm text-card-foreground">Gastar todos al iniciar</span>
        <label class="relative inline-flex w-9 h-5 items-center cursor-pointer select-none">
          <input type="checkbox" id="gc-spendAllPixelsOnStart" class="opacity-0 absolute w-0 h-0" />
          <span data-role="track" class="absolute inset-0 rounded-full transition-colors duration-300 bg-red-500"></span>
          <span data-role="knob" class="absolute left-0.5 top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full transition-transform duration-300 translate-x-0"></span>
        </label>
      </div>
    </div>

    <!-- N칰meros -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">Cargas m칤nimas para esperar</label>
        <input type="number" id="gc-minChargesToWait" min="0" class="w-full p-2 border rounded-md bg-background text-foreground" />
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">P칤xeles por lote</label>
        <input type="number" id="gc-pixelsPerBatch" min="1" class="w-full p-2 border rounded-md bg-background text-foreground" />
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">M치ximo reintentos por lote</label>
        <input type="number" id="gc-maxRetries" min="1" max="10" value="3" class="w-full p-2 border rounded-md bg-background text-foreground" />
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">Estrategia de distribuci칩n</label>
        <select id="gc-chargeStrategy" class="w-full p-2 border rounded-md bg-background text-foreground">
          <option value="greedy">Greedy (칩ptimo API)</option>
          <option value="balanced">Balanced (proporcional)</option>
          <option value="round_robin">Round Robin</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">Bloqueo tras pintar (s)</label>
        <input type="number" id="gc-recentLockSeconds" min="0" class="w-full p-2 border rounded-md bg-background text-foreground" />
      </div>
      <div id="gc-random-times" class="contents">
        <div>
          <label class="block text-sm font-medium mb-2 text-card-foreground">Tiempo m칤nimo (s)</label>
          <input type="number" id="gc-randomWaitMin" step="0.1" min="0" class="w-full p-2 border rounded-md bg-background text-foreground" />
        </div>
        <div>
          <label class="block text-sm font-medium mb-2 text-card-foreground">Tiempo m치ximo (s)</label>
          <input type="number" id="gc-randomWaitMax" step="0.1" min="0" class="w-full p-2 border rounded-md bg-background text-foreground" />
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-card-foreground">Umbral de color</label>
        <input type="number" id="gc-colorThreshold" min="0" max="255" class="w-full p-2 border rounded-md bg-background text-foreground" />
      </div>
    </div>

    <!-- Paletas -->
    <div id="gc-preferredColors-section" style="display:none;">
      <div class="flex items-center justify-between mb-2">
        <h3 class="text-sm font-medium text-card-foreground">Preferidos</h3>
        <button id="gc-clearPreferred" class="px-2 py-1 bg-red-500 text-white rounded text-xs" style="display:none;">Limpiar</button>
      </div>
      <div id="gc-preferredColors" class="flex flex-wrap gap-2"></div>
    </div>
    <div id="gc-excludedColors-section" style="display:none;">
      <div class="flex items-center justify-between mb-2">
        <h3 class="text-sm font-medium text-card-foreground">Excluidos</h3>
        <button id="gc-clearExcluded" class="px-2 py-1 bg-red-500 text-white rounded text-xs" style="display:none;">Limpiar</button>
      </div>
      <div id="gc-excludedColors" class="flex flex-wrap gap-2"></div>
    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-2 pt-2">
      <button id="gc-reset-btn" class="px-3 py-2 bg-gray-600 text-white rounded-md" title="Restablecer">游댃</button>
    </div>
    <div class="text-xs text-muted-foreground"><span id="gc-status"></span></div>
  </div>
</div>
